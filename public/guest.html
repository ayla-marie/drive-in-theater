<!doctype html>

<html lang="en">

<head>
    <meta charset="utf-8">

    <title>The HTML5 Herald</title>
    <meta name="description" content="The HTML5 Herald">
    <meta name="author" content="SitePoint">
</head>

<body>
    <video controls width="0" height="0">
        <source src="/video_stream" type="video/mp4">
        Sorry, your browser doesn't support embedded videos.
    </video>
    <button>Listen Now!</button>
    <script src="/peerjs.min.js"></script>
    <script>
        var createTimer = (initTime) => {
            let start = Date.now();
            const intTime = parseFloat(initTime)
            const getTime = () => Date.now() - start;

            return {
                getTime: () => ((getTime() / 1000) + intTime).toString(),
                setLatency: (secs) => {
                    
                }
            }
        }
        // var timer;
        // var latTimer;

        var btn = document.querySelector('button');
        btn.addEventListener('click', () => {
            const t = timer.getTime()
            console.log(t)
            vid.currentTime = t;
            vid.play();
        })

        var vid = document.querySelector('video');

        // latTimer = createTimer(0);

        ///// TESTING AREA ///////

        var peer = new Peer({host: '/', path: '/peerjs', port: 8080});
        var conn = peer.connect('090909'); /// host id generated..
        conn.on('error', console.log)

        conn.on('open', function(){
            conn.send('hi!');
        });

    </script>
</body>

</html>