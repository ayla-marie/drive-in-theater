<!doctype html>

<html lang="en">

<head>
    <meta charset="utf-8">

    <title>The HTML5 Herald</title>
    <meta name="description" content="The HTML5 Herald">
    <meta name="author" content="SitePoint">
</head>

<body>
    <div class="container">
        <label for="codeEntry">Enter Code</label>
        <input type="text" id="inputCode" placeholder="0000">
        <small>Code not valid</small>
        <audio src="" controls></audio>
        <button>Listen Now!</button>
    </div>
    <script src="/socket.io/socket.io.js"></script>
    <script src="/js/socket.io-stream.js"></script>
    <script>
        var createTimer = (initTime) => {
            let start = Date.now();
            const intTime = parseFloat(initTime)
            const getTime = () => Date.now() - start;

            return {
                getTime: () => ((getTime() / 1000) + intTime).toString(),
                setLatency: (secs) => {

                }
            }
        }
        // var timer;
        // var latTimer;

        var btn = document.querySelector('button');
        var vid = document.querySelector('video');
        btn.addEventListener('click', () => {
            // const t = timer.getTime()
            // console.log(t)
            // vid.currentTime = t;
            // vid.play();
            getAudioFromHost('090909');
        })

        // latTimer = createTimer(0);

        ///// TESTING AREA ///////

        const getAudioFromHost = (hostID) => {
            var peer = new Peer({ host: 'localhost', path: '/peerjs', port: 8080, debug: 0 });
            peer.on('open', function (id) {
                console.log('open~~~')
                peer.on('error', console.log)

                var conn = peer.connect(hostID); /// host id generated.. replace with what input has avalibel
                conn.on('error', console.log)
                conn.on('connection', console.log)
                conn.on('data', function (data) {
                    console.log(59);// getting video data now!
                });
                conn.on('open', function () {
                    // connected to peer!
                });
                console.log('wedwe')
            });
            peer.on('connection', () => {
                console.log('~~~connectiuoins')
            })
        }
    </script>
</body>

</html>